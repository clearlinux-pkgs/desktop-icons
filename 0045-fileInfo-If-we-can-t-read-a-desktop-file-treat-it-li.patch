From a85f68f505d62fbbc3044dba2a588e62e4bed4da Mon Sep 17 00:00:00 2001
From: Iain Lane <iainl@gnome.org>
Date: Wed, 12 Dec 2018 14:25:38 +0000
Subject: [PATCH 45/55] fileInfo: If we can't read a desktop file, treat it
 like a regular file

---
 fileItem.js | 7 ++++++-
 1 file changed, 6 insertions(+), 1 deletion(-)

diff --git a/fileItem.js b/fileItem.js
index 74816bf..d42ba2d 100644
--- a/fileItem.js
+++ b/fileItem.js
@@ -235,8 +235,13 @@ var FileItem = class {
         if (this._isDesktopFile && this._writableByOthers)
             log(`desktop-icons: File ${this._displayName} is writable by others - will not allow launching`);
 
-        if (this._isDesktopFile)
+        if (this._isDesktopFile) {
             this._desktopFile = Gio.DesktopAppInfo.new_from_filename(this._file.get_path());
+            if (!this._desktopFile) {
+                log(`Couldn\'t parse ${this._displayName} as a desktop file, will treat it as a regular file.`);
+                this._isDesktopFile = false;
+            }
+        }
 
         if (this.displayName != oldLabelText) {
             this._label.text = this.displayName;
-- 
2.20.0

